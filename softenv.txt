# install conda
wget https://repo.anaconda.com/miniconda/Miniconda3-py39_4.9.2-Linux-x86_64.sh
bash Miniconda3-py39_4.9.2-Linux-x86_64.sh
# be sure to restart terminal to allow conda to start

conda create -n scqc python=3.8
conda activate scqc

# make sure we have conda-forge
conda config --add channels conda-forge

# update conda if necessary
conda update -n base -c defaults conda

conda install requests pandas ipython scipy wget bottleneck
conda install -c bioconda star
conda install -c conda-forge leidenalg
conda install -c conda-forge scanpy

# install R packages on conda
conda config --set channel_priority strict
# required for R 4.0
conda install -c conda-forge r-base 
conda install -c conda-forge r-essentials
conda install -c conda-forge r-cairo 
conda install -c conda-forge r-ragg


# R pacakges to install
R -e "install.packages('devtools',repos='http://cran.us.r-project.org')"
R -e "install.packages('BiocManager',repos='http://cran.us.r-project.org')"
R -e "install.packages('optparse',repos='http://cran.us.r-project.org')"
R -e "install.packages('Matrix',repos='http://cran.us.r-project.org')"
R -e "BiocManager::install('rhdf5')"
R -e "devtools::install_github('gillislab/MetaMarkers')"



#download sratoolkit, link binaries within conda environment
cd  $CONDA_PREFIX

# linux/centos
wget https://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/2.11.0/sratoolkit.2.11.0-centos_linux64.tar.gz
tar -xvzf sratoolkit.2.11.0-centos_linux64.tar.gz
cd bin
ln -s ../sratoolkit.2.11.0-centos_linux64/bin/* ./

# macos
# wget https://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/2.11.0/sratoolkit.2.11.0-mac64.tar.gz
# tar -xvzf sratoolkit.2.11.0-mac64.tar.gz
# cd bin
#ln -s ../sratoolkit.2.11.0-mac64/bin/* ./





